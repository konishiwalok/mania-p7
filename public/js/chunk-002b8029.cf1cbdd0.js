(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-002b8029"],{"250e":function(t,e,s){},"31ad":function(t,e,s){"use strict";s("3be7")},"3be7":function(t,e,s){},"591a":function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"min-vh-100 d-flex flex-column justify-content-between "},[s("NavbarPost"),s("Jumbo"),t.errorDeletePost?s("b-alert",{attrs:{show:"",dismissible:"",variant:"danger"}},[t._v("Impossible de supprimé votre post. veuillez ressayer ultérieurement ")]):t._e(),t.confirmDeletePost?s("b-alert",{attrs:{show:"",dismissible:"",variant:"success"}},[t._v("Post supprimé")]):t._e(),t.errorComPost?s("b-alert",{attrs:{show:"",dismissible:"",variant:"danger"}},[t._v("Impossible de commenter")]):t._e(),t.confirmComPost?s("b-alert",{attrs:{show:"",dismissible:"",variant:"success"}},[t._v("Commentaire ajouté")]):t._e(),t.errorDeleteCom?s("b-alert",{attrs:{show:"",dismissible:"",variant:"danger"}},[t._v('Impossible de supprimer votre commentaire. veuillez ressayer ultérieurement"')]):t._e(),t.confirmDeleteCom?s("b-alert",{attrs:{show:"",dismissible:"",variant:"success"}},[t._v("Commentaire supprimé")]):t._e(),s("CreatePostBtn"),t._l(t.posts,(function(e){return s("Post",{key:e.id,scopedSlots:t._u([null!==t.posts?{key:"Posts",fn:function(){return[s("div",[s("div",{staticClass:"col d-flex justify-content-between align-items-center p-0 semicua"},[s("div",[s("img",{staticClass:"rounded-circle",attrs:{id:"imgProfile",src:e.User.imageUrl}}),s("span",{staticClass:" font-weight-bold px-3 ml-2"},[t._v(t._s(e.User.pseudo))])]),s("span",{staticClass:"badge text-white align-self-start p-0"},[t._v(t._s(e.createdAt.substr(0,10).split("-").reverse().join("-")))])]),s("div",{staticClass:"row mx-auto "},[s("div",{staticClass:"col-11 card my-3 py-2 mx-auto semicua_com"},[t._v(" "+t._s(e.content)+" "),e.imageUrl?s("b-img-lazy",{staticClass:"semicua mx-auto pt-1",attrs:{src:e.imageUrl,"fluid-grow":"",alt:"responsive image"}}):t._e()],1),s("hr",{staticClass:"line w-100 mb-1"})])])]},proxy:!0}:null,null!==t.comments?{key:"Comments",fn:function(){return t._l(t.comments.filter((function(t){return t.postId==e.id})),(function(e){return s("div",{key:e.id,staticClass:"container-fluid"},[t.comments.postId==t.posts.id?s("div",{staticClass:"row d-flex  justify-content-between align-items-center comment-area py-1"},[s("img",{staticClass:"imgComment align-self-start",attrs:{src:e.User.imageUrl}}),s("span",{staticClass:"align-self-start p-1",attrs:{id:"userNameComment"}},[t._v(t._s(e.User.pseudo))]),s("p",{staticClass:"col-8 text-left mb-0 pt-1  font-weight-bold"},[t._v(t._s(e.content))]),t.userId==e.userId||1==t.currentUser.isAdmin?s("button",{staticClass:"col-1 p-0 btn",attrs:{id:"delcom",type:"submit"},on:{click:function(s){return s.preventDefault(),t.deleteCom(e.id)}}},[s("i",{staticClass:"text-dark fa fa-times"})]):t._e()]):t._e(),s("hr",{staticClass:"line w-100 mt-1 mb-0 p-0"})])}))},proxy:!0}:null,{key:"EditCom",fn:function(){return[s("form",{staticClass:"container-fluid mt-2 ",on:{submit:function(s){return s.preventDefault(),t.sendCom(e.id)}}},[s("div",{staticClass:"form-group row"},[s("label",{staticClass:"sr-only",attrs:{for:"comment"}}),s("b-form-textarea",{staticClass:"col-11 form-control-sm mx-auto",attrs:{id:"newComment",name:"comment",type:"text","aria-label":"Zone d'un commentaire",placeholder:"Commenter",required:""},model:{value:t.$v.newComment.$model,callback:function(e){t.$set(t.$v.newComment,"$model","string"===typeof e?e.trim():e)},expression:"$v.newComment.$model"}}),t.$v.newComment.maxLength?t._e():s("div",{staticClass:"error"},[t._v("Max. "+t._s(t.$v.newComment.$params.maxLength.max)+" letters")])],1),s("div",[s("button",{staticClass:"btn  btn-light rounded py-1 px-2 mt-2 mr-3",attrs:{id:"sendcom",type:"submit","aria-label":"Publication d'un commentaire"}},[t._v("Commenter")]),t.userId==e.userId||1==t.currentUser.isAdmin?s("button",{staticClass:"btn btn-primary bg-danger border-white rounded py-1 px-3 mt-2",attrs:{id:"delpost",type:"submit","aria-label":"Supprimer le post"},on:{click:function(s){return s.preventDefault(),t.deletePost(e.id)}}},[s("i",{staticClass:"fa fa-trash"})]):t._e()])])]},proxy:!0}],null,!0)})})),s("Footer")],2)},n=[],a=s("1da1"),r=(s("96cf"),s("77a4")),i=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},l=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"jumbotron p-2"},[s("h1",{staticClass:"h2"},[t._v("Bienvenue sur Groupomania! ")])])}],c={name:"Jumbo"},m=c,u=(s("f5a8"),s("2877")),d=Object(u["a"])(m,i,l,!1,null,"0f96df0b",null),p=d.exports,f=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"col-lg-7 offset-lg-3 mx-auto"},[s("div",{staticClass:"row mx-auto"},[s("div",{staticClass:"col-lg-8 mx-auto masespacio"},[s("div",{staticClass:"card my-3 bg-primary mx-auto "},[t._m(0),s("div",[s("p",{staticClass:"text-white font-weight-bold"},[t._v(" "+t._s(t.pseudo))])]),s("div",{staticClass:"card-body py-2"},[s("div",{staticClass:"d-flex"},[s("div",{staticClass:"col"},[s("form",{attrs:{enctype:"multipart/form-data"},on:{submit:function(e){return e.preventDefault(),t.createPost.apply(null,arguments)}}},[s("div",{staticClass:"form-group mb-0"},[s("label",{staticClass:"sr-only",attrs:{for:"content"}},[t._v("Créer un post")]),s("b-form-textarea",{staticClass:"form-control border-0",attrs:{name:"content",type:"text",id:"content",rows:"2",placeholder:"What's on your mind ?"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),t.uploadUrl?s("b-img-lazy",{attrs:{src:t.uploadUrl,fluid:""}}):t._e(),s("span",{staticClass:"text-center text-white font-weight-bold"},[t._v(t._s(t.image.name))]),t.$v.content.maxLength?t._e():s("div",{staticClass:"error"},[t._v("Max. "+t._s(t.$v.content.$params.maxLength.max)+" letters")])],1),s("div",{staticClass:"form-group mt-3"},[s("label",{staticClass:"btn btn-info border-white  font-weight-bold mt-2",attrs:{id:"imageLabel",for:"image"}},[t._v("Ajouter une image")]),s("input",{ref:"image",attrs:{type:"file",name:"image",id:"image"},on:{change:function(e){return t.handleFileUpload()}}}),s("button",{staticClass:"btn btn-light font-weight-bold ml-3",attrs:{type:"submit"}},[t._v("Envoyer")])])])])])])])])]),t.errorAlert?s("b-alert",{attrs:{show:"",dismissible:"",variant:"danger"}},[t._v("Une erreur est survenue")]):t._e(),t.blankPost?s("b-alert",{attrs:{show:"",dismissible:"",variant:"danger"}},[t._v("C'est vide")]):t._e()],1)},h=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card-header mimania "},[s("h1",{staticClass:"e"},[t._v(" Fais un commentaire ")])])}],b=(s("d3b7"),s("3ca3"),s("ddb0"),s("2b3d"),s("b5ae")),v=s("bc3a"),g=s.n(v),C={name:"createPostBtn",data:function(){return{userId:parseInt(localStorage.getItem("userId")),pseudo:localStorage.getItem("pseudo"),content:"",image:"",uploadUrl:"",postId:"",errorAlert:!1,blankPost:!1}},validations:{content:{maxLength:Object(b["maxLength"])(140)}},methods:{handleFileUpload:function(){this.image=this.$refs.image.files[0],this.uploadUrl=URL.createObjectURL(this.image)},createPost:function(){var t=this;if(this.blankPost=!1,this.content||this.image){this.$v.$touch();var e=new FormData;e.append("image",this.image),e.append("content",this.content),e.append("userId",parseInt(localStorage.getItem("userId"))),g.a.post("http://localhost:3000/api/post/new",e,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+localStorage.getItem("token")}}).then((function(){t.$router.go()})).catch((function(){t.errorAlert=!0,console.log(e)}))}else this.blankPost=!0}}},_=C,w=(s("ef44"),Object(u["a"])(_,f,h,!1,null,"36676486",null)),x=w.exports,y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container-fluid "},[s("div",{staticClass:"row mx-auto mb-5"},[s("div",{staticClass:"col-9 col-md-8 col-lg-6 mx-auto border rounded mimania py-2"},[t._t("Posts"),t._t("Comments"),t._t("EditCom")],2)])])},P=[],$={name:"Post",data:function(){return{}}},k=$,I=(s("794c"),Object(u["a"])(k,y,P,!1,null,"cc37e6cc",null)),U=I.exports,A=s("fd2d"),D={name:"Allpost",components:{NavbarPost:r["a"],Jumbo:p,CreatePostBtn:x,Post:U,Footer:A["a"]},data:function(){return{token:localStorage.getItem("token"),userId:parseInt(localStorage.getItem("userId")),pseudo:localStorage.getItem("pseudo"),isAdmin:localStorage.getItem("isAdmin"),posts:[],comments:[],currentUser:[],user:{pseudo:"",imageUrl:"",id:"",isAdmin:""},newComment:"",errorDeletePost:!1,confirmDeletePost:!1,errorDeleteCom:!1,confirmDeleteCom:!1,errorComPost:!1,confirmComPost:!1}},validations:{newComment:{required:b["required"],maxLength:Object(b["maxLength"])(140)}},created:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g.a.get("http://localhost:3000/api/users/profile",{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+t.token}}).then((function(e){t.currentUser=e.data,console.log(e)})).catch((function(t){console.log(t+"User inconnu")}));case 2:return e.next=4,g.a.get("http://localhost:3000/api/post",{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+t.token}}).then((function(e){t.posts=e.data,console.log(e)})).catch((function(e){console.log(e+"User inconnu ou Posts indisponibles"),t.$router.push("/login"),window.alert("Veuillez vous connecter pour accéder au site")}));case 4:return e.next=6,g.a.get("http://localhost:3000/api/post/comment",{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+t.token}}).then((function(e){t.comments=e.data,console.log(e)})).catch((function(t){console.log(t+"User inconnu ou comments indisponibles")}));case 6:case"end":return e.stop()}}),e)})))()},methods:{sendCom:function(t){var e=this;this.$v.$touch();var s=JSON.stringify({content:this.newComment});g.a.post("http://localhost:3000/api/post/"+t+"/comment",s,{headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.token}}).then((function(){e.$router.go(),e.confirmComPost=!0})).catch((function(){e.errorComPost=!0}))},deleteCom:function(t){var e=this;g.a.delete("http://localhost:3000/api/post/"+t+"/comment",{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+this.token}}).then((function(){e.$router.go(),e.confirmDeleteCom=!0})).catch((function(){e.errorDeleteCom=!0}))},deletePost:function(t){var e=this;g.a.delete("http://localhost:3000/api/post/"+t,{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+this.token}}).then((function(){e.$router.go(),e.confirmDeletePost=!0})).catch((function(){e.errorDeletePost=!0}))}}},j=D,z=(s("31ad"),Object(u["a"])(j,o,n,!1,null,"39ba3fee",null));e["default"]=z.exports},"794c":function(t,e,s){"use strict";s("df78")},d9b7:function(t,e,s){},df78:function(t,e,s){},ef44:function(t,e,s){"use strict";s("250e")},f5a8:function(t,e,s){"use strict";s("d9b7")}}]);
//# sourceMappingURL=chunk-002b8029.cf1cbdd0.js.map